# Source R Scripts

----

The Four Data Preparation Steps

1. **Organize the raw data files**. This involves moving the raw *.edat* files from *Tasks/Session #/#. Task/data* to *Data Files/edat/Task/*.

2. **Merge** the individual *.edat* files into a single **task.emrg** file using *E-Merge*

3. **Export** the **task.emrg** file to a **task.txt** file so we can process the data in **R**

4. **Source** the **0_task_raw.R** *Scripts* 

----

The final data preparation step is to **Source** the **0_task_raw.R** scripts. These scripts convert the messy **task.txt** files to tidy **task_raw.csv** files. 

## Creating R Scripts

There should be a template R Script in the directory **R Scripts/templates**. If not you can download a template by typing into the console:

```{r eval = FALSE}
workflow::template(rawscript = TRUE)
```

To understand more about this template R Script see [**Chapter 9.2.1**](http://englelab.gatech.edu/userguide/r-script-templates.html#messy-to-tidy-script){target="_blank"} in the **UseR Guide**.

To learn how to create an R Script for this step see the [**Data Preparation**](http://englelab.gatech.edu/userguide/data-preparation-overview.html){target="_blank"} section of the **UseR Guide**.

## Using the masterscript.R

It may be the case that ALL the R Scripts have been created and all you need to do is `source()` them all. 

You can do this easily in the file **masterscript.R**

If there is not a mastersrcipt file then you can download one by typing into the console:

```{r eval = FALSE}
workflow::template(masterscript = "data preparation")
```

To understand more about the masterscript see [**Chapter 9.2.2**](http://englelab.gatech.edu/userguide/r-script-templates.html#masterscript-data-preparation){target="_blank"} in the **UseR Guide**

The masterscript for data preparation is simple and looks something like:

```{r eval = FALSE}
## Data Preparation for StudyName


#############################################
#------ 0. "messy" to "tidy" raw data ------#
#############################################
library(here)

source(here("R Scripts", "0_taskname_raw.R"), echo=TRUE)

rm(list=ls())
#############################################
```

For each task there should be an R Script file - **0_taskname_raw.R**

For each of these R Script files there should be a line in the masterscript to `source()` that file.

*Note: `source()` or Sourcing means to execute all lines of code in a file.*

In the masterscript we are using the `here()` function. To learn more about the `here()` function see [**Chapter 8.3.1**](http://englelab.gatech.edu/userguide/reproducible-practices.html#working-directory){target="_blank"} in the **UseR Guide**.

If there is not a line in the masterscript to `source()` an R Script file then you should most likely add it.

Finally, you can run each line of code in the masterscript, one at a time. Running them run at a time makes it easier to catch any errors that might come up.

Start at the first line of code: `library(here)` and press Ctrl+Enter

Wait for that line of code to finish running, then press Ctrl+Enter (The cursor should have automatically moved to the next line).

If there were any errors you can feel free to try and troubleshoot. Otherwise get a graduate student or PostDoc to help out.



